#!/bin/bash

# Output CSV file
REPORT="pokemon_report.csv"

# Header
echo "Name,Height (m),Weight (kg)" > "$REPORT"

# Process each JSON file
for file in pokemon_data/*.json; do
  # Extract values
  name=$(jq -r '.name' "$file" | awk '{print toupper(substr($0,1,1)) tolower(substr($0,2))}')
  height=$(jq -r '.height' "$file")
  weight=$(jq -r '.weight' "$file")

  # Convert height to meters and weight to kg (API returns decimetres and hectograms)
  height_m=$(awk "BEGIN {printf \"%.2f\", $height * 0.1}")
  weight_kg=$(awk "BEGIN {printf \"%.2f\", $weight * 0.1}")


echo -e "\nCSV Report generated at: $REPORT"
  # Append to CSV
  echo "$name,$height_m,$weight_kg" >> "$REPORT"
done



# Compute averages using awk
awk -F, '
  NR > 1 {
    height += $2
    weight += $3
    count++
  }
  END {
    printf "\nAverage Height: %.2f m\n", height/count
    printf "Average Weight: %.2f kg\n", weight/count
  }
' "$REPORT"
